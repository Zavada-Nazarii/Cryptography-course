# üõ°Ô∏è E2EE Chat ‚Äî CLI –ó–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –∑ –Ω–∞—Å–∫—Ä—ñ–∑–Ω–∏–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º 

–¶–µ–π –ø—Ä–æ—î–∫—Ç —Ä–µ–∞–ª—ñ–∑—É—î –ø—Ä–æ—Å—Ç–∏–π –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ –¥–ª—è –æ–±–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –∑ –Ω–∞—Å–∫—Ä—ñ–∑–Ω–∏–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º (End-to-End Encryption) –º—ñ–∂ –¥–≤–æ–º–∞ —Å—Ç–æ—Ä–æ–Ω–∞–º–∏: **Alice** —Ç–∞ **Bob**.

---

## üîê –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—ñ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ –º–µ—Ç–æ–¥–∏

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç                      | –ú–µ—Ç–æ–¥ / –ê–ª–≥–æ—Ä–∏—Ç–º                | –ü—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è                                       |
|-------------------------------|----------------------------------|--------------------------------------------------|
| –û–±–º—ñ–Ω –∫–ª—é—á–∞–º–∏                 | ECDH –Ω–∞ Curve25519 (X25519)      | –£–∑–≥–æ–¥–∂–µ–Ω–Ω—è —Å–ø—ñ–ª—å–Ω–æ–≥–æ —Å–µ—Å—ñ–π–Ω–æ–≥–æ –∫–ª—é—á–∞             |
| –ü—ñ–¥–ø–∏—Å—É–≤–∞–Ω–Ω—è                  | Ed25519                          | –í–∑–∞—î–º–Ω–∞ –∞–≤—Ç–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—è (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ MITM)         |
| –°–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è         | AES-GCM                          | –ö–æ–Ω—Ñ—ñ–¥–µ–Ω—Ü—ñ–π–Ω—ñ—Å—Ç—å + —Ü—ñ–ª—ñ—Å–Ω—ñ—Å—Ç—å                    |
| –•–µ—à—É–≤–∞–Ω–Ω—è / KDF               | HKDF (SHA-256)                   | –û—Ç—Ä–∏–º–∞–Ω–Ω—è –∫–ª—é—á–∞ –∑ DH —Å–µ–∫—Ä–µ—Ç—É                     |
| Replay –∑–∞—Ö–∏—Å—Ç                 | Nonce                            | –ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å    |
| –ü—Ä—è–º–∞ —Å–µ–∫—Ä–µ—Ç–Ω—ñ—Å—Ç—å             | –ù–æ–≤–∏–π DH –∫–ª—é—á –Ω–∞ –∫–æ–∂–Ω—É —Å–µ—Å—ñ—é     | –ö–ª—é—á—ñ –Ω–µ –ø–æ–≤—Ç–æ—Ä—é—é—Ç—å—Å—è –º—ñ–∂ —Å–µ—Å—ñ—è–º–∏                |

---

## üìÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É

```
e2ee_chat/
‚îú‚îÄ‚îÄ alice.py               # Alice: —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è, –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–∏–π —á–∞—Ç
‚îú‚îÄ‚îÄ bob.py                 # Bob: –ø—Ä–∏–π–æ–º, —ñ–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è, –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–∏–π —á–∞—Ç
‚îú‚îÄ‚îÄ crypto_utils.py        # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó (ECDH, AES, Ed25519)
‚îú‚îÄ‚îÄ utils.py               # –ü–∞–∫—É–≤–∞–Ω–Ω—è/—Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω—å, –ø–æ—Ä—Ç
‚îú‚îÄ‚îÄ README.md              # –û–ø–∏—Å –ø—Ä–æ—î–∫—Ç—É —Ç–∞ –∑–∞–ø—É—Å–∫—É
```

---

## üöÄ –Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –∑–∞–ø—É—Å–∫—É

1. **–£ –ø–µ—Ä—à–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –∑–∞–ø—É—Å—Ç–∏—Ç–∏ Bob:**
```bash
python bob.py
```

2. **–£ –¥—Ä—É–≥–æ–º—É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –∑–∞–ø—É—Å—Ç—ñ—Ç—å Alice:**
```bash
python alice.py
```

3. **–û–±–º—ñ–Ω—é–π—Ç–µ—Å—è –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ —É –≤—ñ–ª—å–Ω–æ–º—É —Ä–µ–∂–∏–º—ñ:**
- –ø–µ—Ä—à–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ–≤–∏–Ω–µ–Ω –≤—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ **bob**
- –¥–∞–ª—ñ, –æ–±–∏–¥–≤—ñ —Å—Ç–æ—Ä–æ–Ω–∏ –º–æ–∂—É—Ç—å –æ–¥–Ω–æ—á–∞—Å–Ω–æ –ø–∏—Å–∞—Ç–∏ —Ç–∞ –æ—Ç—Ä–∏–º—É–≤–∞—Ç–∏

---

## ‚öôÔ∏è –ü–æ—è—Å–Ω–µ–Ω–Ω—è –æ—Å–Ω–æ–≤–Ω–∏—Ö —Ñ—É–Ω–∫—Ü—ñ–π

### `crypto_utils.py`

- `generate_dh_keypair()` ‚Äî –≥–µ–Ω–µ—Ä—É—î –ø–∞—Ä—É –∫–ª—é—á—ñ–≤ ECDH (X25519)
- `derive_shared_key(priv, pub)` ‚Äî –æ—Ç—Ä–∏–º—É—î —Å–ø—ñ–ª—å–Ω–∏–π —Å–µ–∫—Ä–µ—Ç —Ç–∞ –≥–µ–Ω–µ—Ä—É—î –∫–ª—é—á –∑ –Ω—å–æ–≥–æ (HKDF)
- `encrypt_aes_gcm(key, msg)` ‚Äî —à–∏—Ñ—Ä—É—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –∑ nonce (AES-GCM)
- `decrypt_aes_gcm(key, ciphertext, nonce)` ‚Äî —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
- `sign_data(priv, data)` ‚Äî Ed25519 –ø—ñ–¥–ø–∏—Å
- `verify_signature(pub, sig, data)` ‚Äî –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –ø—ñ–¥–ø–∏—Å—É
- `load_or_generate_ed25519(name)` ‚Äî —Å—Ç–≤–æ—Ä—é—î/–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –∫–ª—é—á—ñ Ed25519
- `load_ed25519_public_key(file)` ‚Äî –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î Ed25519 –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á

### `utils.py`

- `SERVER_PORT = 8888` ‚Äî –ø–æ—Ä—Ç –¥–ª—è –∑–≤‚Äô—è–∑–∫—É
- `pack_message(...)` ‚Äî —É–ø–∞–∫–æ–≤—É—î DH –∫–ª—é—á, nonce, ciphertext —ñ signature
- `unpack_message(data)` ‚Äî —Ä–æ–∑–ø–∞–∫–æ–≤—É—î –æ—Ç—Ä–∏–º–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è

---

